unit uProdutoController;

interface

uses ProdutoModel, FireDAC.Comp.Client, System.SysUtils;

Type
  TProdutoController = class

    class function BuscaProdutoId(cod: integer): TProdutoModel;
  end;

implementation

{ TProdutoController }

uses uDm;

class function TProdutoController.BuscaProdutoId(cod: integer): TProdutoModel;
var
  QueryCons: TFDQuery;
  Produto: TProdutoModel;
begin
  try
    QueryCons := TFDQuery.Create(Nil);
    QueryCons.Connection := Dm.FConexao;
    Produto := TProdutoModel.Create();

    with QueryCons do
    begin
      sql.Add('select * from produto where codigo = :cod');
      parambyname('cod').AsInteger := cod;
      open;
    end;

    if Not(QueryCons.IsEmpty) then
    Begin

      Produto.codigo := QueryCons.FieldByName('codigo').AsInteger;
      Produto.descricao := QueryCons.FieldByName('descricao').AsString;
      Produto.preco_venda := QueryCons.FieldByName('valor_venda').AsFloat;

    End;

    Result := Produto;

  finally
    FreeAndNil(QueryCons);
  end;

end;

end.
